library(readxl)
ProjectDataPoints_1_ <- read_excel("~/Desktop/EVO.FP excels/ProjectDataPoints(1).xlsx")
View(ProjectDataPoints_1_)
setwd("/Users/efama137/Desktop/Evolution/Tasks/FinalProject/data")
Data1 <- read.csv("ProjectDataPoints1.csv")
Data2 <- read.csv("ProjectDataPoints2.csv")
library(ggplot2)
library(phytools)
library(dplyr)
library(hierfstat)
library(adegenet)
Data1<-subset(Data1, select = -c(Sample.site, Peq03, Peq04, Peq06, Peq08, Peq09, Peq11, Peq12, Peq19, Peq20, X.2, X.3, X.5, X.6, X.7, X.9, X.10, X.16, X.17))
Data2<-subset(Data2, select = -c(Peq07, X.3))
Data1<- Data1 %>%
rename(Peq01a = Peq01,
Peq01b = X,
Peq02a = Peq02,
Peq02b = X.1,
Peq05a = Peq05,
Peq05b = X.4,
Peq10a = Peq10,
Peq10b = X.8,
Peq13a = Peq13,
Peq13b = X.11,
Peq14a = Peq14,
Peq14b = X.12,
Peq15a = Peq15,
Peq15b = X.13,
Peq17a = Peq17,
Peq17b = X.14,
Peq18a = Peq18,
Peq18b = X.15)
Data2<- Data2 %>%
rename(Peq01a = Peq01,
Peq01b = X,
Peq02a = Peq02,
Peq02b = X.1,
Peq05a = Peq05,
Peq05b = X.2,
Peq10a = Peq10,
Peq10b = X.4,
Peq13a = Peq13,
Peq13b = X.5,
Peq14a = Peq14,
Peq14b = X.6,
Peq15a = Peq15,
Peq15b = X.7,
Peq17a = Peq17,
Peq17b = X.8,
Peq18a = Peq18,
Peq18b = X.9)
DATA<-rbind(Data1,Data2)
TrueDATA<-na.omit(DATA)
Population<-TrueDATA[, c("POPULATION")]
microsatellites<-TrueDATA[, c("Peq01a", "Peq01b", "Peq02a", "Peq02b", "Peq05a", "Peq05b", "Peq10a", "Peq10b", "Peq13a", "Peq13b", "Peq14a","Peq14b", "Peq15a", "Peq15b", "Peq17a", "Peq17b", "Peq18a", "Peq18b")]
pca_result <- prcomp(microsatellites, scale.=TRUE)
summary(pca_result)
par(mfrow=c(1,1), mar=c(5,5,2,2))
plot(pca_result$x[,1], pca_result$x[,2],
col=1:length(unique(TrueDATA$POPULATION)),
xlab="PC1", ylab="PC2", main="PCA of microsatellite data")
legend("bottomright", legend=unique(TrueDATA$POPULATION),
col=1:length(unique(TrueDATA$POPULATION)), pch=10, cex=0.3)
dev.off()
par(mfrow=c(1,1), mar=c(5,5,2,2))
plot(pca_result$x[,5], pca_result$x[,18],
col=1:length(unique(TrueDATA$POPULATION)),
xlab="PC1", ylab="PC2", main="PCA of microsatellite data")
legend("bottomright", legend=unique(TrueDATA$POPULATION),
col=1:length(unique(TrueDATA$POPULATION)), pch=10, cex=0.3)
Pops <- unique(DATA$POPULATION)
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(mar=c(5,4,1,1))
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
par(cex.axis=0.5)
dev.off()
par(mar=c(5,4,1,1))
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(mar=c(5,4,1,1))
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
par(cex.axis=0.5)
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(mar=c(5,4,1,1), cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(mar=c(5,4,1,1))
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
par(cex.axis=0.5)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
par(cex.axis=0.5)
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
par(mar=c(5,4,1,1))
par(cex.axis=0.5)
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
dev.off()
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(mar=c(5,4,1,1), las=2)
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
Pops <- unique(DATA$POPULATION)
isA <- grep("a", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isA))
par(mar=c(5,4,1,1), las=2)
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isA){
MeansA <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansA, pch=16, col=Cols[counter])
counter <- counter + 1
}
dev.off()
boxplot(Peq01a ~ POPULATION, data = DATA, par(las=3), par(cex.axis=0.5))
dev.off()
boxplot(microsatellites ~ Population, par(las=3), par(cex.axis=0.5))
populations<-unique(DATA$POPULATION)
Pops <- unique(DATA$POPULATION)
isB <- grep("b", colnames(DATA))
counter <- 1
Cols <- rainbow(length(isB))
par(mar=c(5,4,1,1), las=2)
par(cex.axis=0.5)
plot(0, 300, ylim=c(0, 300), xaxt="n", xlab="", ylab="", xlim=c(1,length(Pops)), type="n")
axis(1, at=1:length(Pops), labels=Pops, srt=90)
for (i in isB){
MeansB <- tapply(DATA[,i], DATA$POPULATION, mean, na.rm=T)
points(1:length(Pops), MeansB, pch=16, col=Cols[counter])
counter <- counter + 1
}
legend("topright", legendcolnames(DATA)[isB], col=Cols, pch=16, cex=0.8)
legend("topright", legend=colnames(DATA)[isB], col=Cols, pch=16, cex=0.8)
legend("topright", legend=colnames(DATA)[isB], title="PeqB", col=Cols, pch=16, cex=0.8)
dev.off()
par(mfrow=c(1,1), mar=c(5,5,2,2))
plot(pca_result$x[,1], pca_result$x[,2],
col=1:length(unique(TrueDATA$POPULATION)),
xlab="PC1", ylab="PC2", main="PCA of microsatellite data")
legend("bottomright", legend=unique(TrueDATA$POPULATION),
col=1:length(unique(TrueDATA$POPULATION)), pch=10, cex=0.3)
par(mfrow=c(1,1), mar=c(5,5,2,2))
plot(pca_result$x[,1], pca_result$x[,2],
col=1:length(unique(TrueDATA$POPULATION)),
xlab="PC1", ylab="PC2", main="PCA of microsatellite data")
legend("bottomright", legend=unique(TrueDATA$POPULATION),
col=1:length(unique(TrueDATA$POPULATION)), pch=1, cex=0.3)
