Library(swirl)
Library (swirl)
swirl()
5
A <- 5
A * 2
B <- c(A, 5, 5)
B
B * 2
'B' * 2
B <- c(A, 5, 5)
B * 2
C <- c(B, 6, 10)
C * 6
D <- c(1, 5, 10, 15, 20)
sum(D)
mean(D)
min(D)
E <- c(1, 5, 10, 15, 20)
#Which Element of E is 8 ?: None "interger(0)"
#Whihc element of E is > 8 ?: 10,15,20 "[1] 3 4 5"
which (E == 8)
which (E > 8)
E[which (E > 8)]
trueMean1 <- 5
trueSD1 <- 5
population1 <- rnorm(1e6, trueMean1, trueSD1)
trueMean2 <- 4
trueSD2 <- 5
population2 <- rnorm(1e6, trueMean2, trueSD2)
#Q?: what is the meaning of "1e6" and "rnrom"
Size <- 50
Sample1 <- sample(population1, Size)
Sample2 <- sample(population2, Size)
#Compare samples, were populations different?: Yes, The numbers that popped up in values under samples 1 and 2 are different, However I am not sure what the specific numbers mean
boxplot(Sample1, Sample2)
individual1 <- c("B", "A")
individual2 <- c("A", "A")
Gam1 <- sample(individual1, 1)
Gam2 <- sample(individual2, 1)
#Q?: what is the purpose of the "1"
newBaby <- c(Gam1, Gam2)
#genotype of New Baby?: newBaby = B and A "chr [1:2] "B" "A""
isHet <- c()
for (i in 1:100) {
Gam1 <- sample(individual1, 1)
Gam2 <- sample(individual2, 1)
newBaby <- c(Gam1, Gam2)
isHet [i] <- Gam1 == Gam2
}
sum(isHet) / length(isHet)
#Is the fraction of the heterozygotes what you expected for ABxAA cross?: I expected .5 and got .49
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma <- makeFounder("grandma_mom")
MatGrandpa <- makeFounder("grandpa_mom")
PatGrandma <- makeFounder("grandma_da")
PatGrandpa <- makeFounder("grandpa_da")
head(MatGrandma)
nrow(MatGrandma)
head(MatGrandpa)
nrow(MatGrandpa)
head(PatGrandma)
nrow(PatGrandpa)
#Q?: I dont quite understand either response (what are the 2 rows, what does the z mean)(does nrow give "10000" because we are modeling 10,000 loci?)
Alan <- makeBaby(PatGrandma, PatGrandpa)
head(Alan)
nrow(Alan)
Brenda <- makeBaby(MatGrandma, MatGrandpa)
head(Brenda)
nrow(Brenda)
Focus <- makeBaby(Brenda, Alan)
#Q?: Does the Female always go first? How would it effect the response if they were switched?
#Before looking at the ToMom object what should the number be?: around 0.5 "0.5"
ToMom <- length( grep("mom", Focus)) / length(Focus)
ToMomMom <- length(grep("grandma_mom", Focus)) / length(Focus)
ToMomDad <- length(grep("grandpa_mom", Focus)) / length(Focus)
#What is ToMomMom added to ToMomDad? What Does it represent?: 0.49, it represent the percent of DNA that is from the Gradparents of the moms side, or the %DNA from the mother.
#
Sibling_01 <- makeBaby(Brenda, Alan)
#
ToSib <- length(intersect(Focus, Sibling_01)) / length(Focus)
#
ManySiblings <- replicate(1e3, length(intersect(Focus, makeBaby(Brenda, Alan))) / length(Focus))
quantile(ManySiblings)
mean(ManySiblings)
hist(ManySiblings)
library(adegenet)
library(poppr)
library(dplyr)
library(hierfstat)
library(reshape2)
library(ggplot2)
library(RColorBrewer)
library(scales)
coalescent.plot()
library(learnPopGen)
library(adegenet)
library(poppr)
library(dplyr)
library(hierfstat)
library(reshape2)
library(ggplot2)
library(RColorBrewer)
library(scales)
lobster<-read.csv("https://jonsmitchell.com/data/lobster_genotypes.csv")
lobster_wide <- reshape(lobster, idvar = c("ID", "Site"), timevar = "Locus", direction = "wide", sep = "")
colnames(lobster_wide) <- gsub("Genotype", "", colnames(lobster_wide))
snpgeno <- lobster_wide[, 3:ncol(lobster_wide)]
library(phytools)
setwd("/Users/efama137/Desktop/Evolution/Tasks/Task_07")
text.string<-
"(((((((cow, pig), whale),(bat,(lemur,human))),(robin,iguana)),coelacanth),(gold_fish, trout)),shark);"
vert.tree<-read.tree(text=text.string)
plot(vert.tree, edge.width=2)
nodelabels(frame="circle", bg='white', cex=1)
vert.tree
str(vert.tree)
tree<-read.tree(text="(((A,B),(C,D)),E);")
plotTree(tree,offset=1)
tiplabels(frame="circle", bg='lightblue', cex=1)
nodelabels(frame="circle", bg='white', cex=1)
tree$tip.label
tree$edge
AnolisTree<- force.ultrametric(read.tree("https://jonsmitchell.com/data/anolis.tre"))
par(las=1)
hist(AnolisTree$edge.length, col='black', border='white', main="", xlab="edge lengths for the Anolis tree", ylim=c(0, 50), xlim=c(0, 6))
tipEdges<-which(AnolisTree$edge[,2] <= Ntip(AnolisTree))
Lengths<-AnolisTree$edge.length
names(Lengths)<-AnolisTree$tip.label
names(Lengths)[which(Lengths == min(Lengths))]
plot(AnolisTree, cex=0.25)
Labs<-sapply(AnolisTree$edge.length, round, digits=2)
edgelables(text=Labs, cex=0.25)
edgelabels(text=Labs, cex=0.25)
View(AnolisTree)
View(AnolisTree)
View(tree)
?plot.phylo
View(tree)
ltt(AnolisTree)
abline(0, 1, lwd=2, col='red', lty=2)
plot(tree, type="fan")
data<-read.csv("https://jonsmitchell.com/data/svl.csv", stringsAsFactors = F, row.names=1)
Ancestors<-fastAnc(tree, svl, vars=TRUE, CI=TRUE)
Ancestors <- fastAnc(tree, svl, vars=TRUE, CI=TRUE)
library(phytools)
setwd("/Users/efama137/Desktop/Evolution/Tasks/Task_07")
text.string<-
"(((((((cow, pig), whale),(bat,(lemur,human))),(robin,iguana)),coelacanth),(gold_fish, trout)),shark);"
vert.tree<-read.tree(text=text.string)
plot(vert.tree, edge.width=2)
nodelabels(frame="circle", bg='white', cex=1)
vert.tree
str(vert.tree)
tree<-read.tree(text="(((A,B),(C,D)),E);")
plotTree(tree,offset=1)
tiplabels(frame="circle", bg='lightblue', cex=1)
nodelabels(frame="circle", bg='white', cex=1)
tree$tip.label
tree$edge
AnolisTree<- force.ultrametric(read.tree("https://jonsmitchell.com/data/anolis.tre"))
par(las=1)
hist(AnolisTree$edge.length, col='black', border='white', main="", xlab="edge lengths for the Anolis tree", ylim=c(0, 50), xlim=c(0, 6))
tipEdges<-which(AnolisTree$edge[,2] <= Ntip(AnolisTree))
Lengths<-AnolisTree$edge.length
names(Lengths)<-AnolisTree$tip.label
names(Lengths)[which(Lengths == min(Lengths))]
plot(AnolisTree, cex=0.25)
Labs<-sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
?plot.phylo
plot(tree, tip.label="")
plot(tree, type="fan")
plot(tree, tip.color="red")
shortedge<-min(tree$edge.length)
which()
shortest_edge<-min(tree$edge.length)
summary(tree$edge.length)
summary(AnolisTree$edge.length)
shortest_edge<-min(AnolisTree$edge.length)
Ntip(AnolisTree)
shortest_edge_indices <- which(AnolisTree$edge.length == shortest_edge)
AnolisTree$edge.length[AnolisTree$edge.length == shortest_edge] <- NA
Ntip(AnolisTree)
AnolisTree2<-drop.tip(AnolisTree, tip = 82L)
Ntip(AnolisTree)
plot(AnolisTree2)
Ntip(AnolisTree)
plot(AnolisTree2, cex = 0.25)
Ntip(AnolisTree)
Ntip(AnolisTree2)
ltt(AnolisTree2)
ltt(AnolisTree)
setwd("/Users/efama137/Desktop/Evolution/Tasks/Task_07")
text.string<-
"(((((((cow, pig), whale),(bat,(lemur,human))),(robin,iguana)),coelacanth),(gold_fish, trout)),shark);"
vert.tree<-read.tree(text=text.string)
library(phytools)
vert.tree<-read.tree(text=text.string)
plot(vert.tree, edge.width=2)
nodelabels(frame="circle", bg='white', cex=1)
vert.tree
str(vert.tree)
tree<-read.tree(text="(((A,B),(C,D)),E);")
plotTree(tree,offset=1)
tiplabels(frame="circle", bg='lightblue', cex=1)
nodelabels(frame="circle", bg='white', cex=1)
tree$tip.label
tree$edge
AnolisTree<- force.ultrametric(read.tree("https://jonsmitchell.com/data/anolis.tre"))
par(las=1)
hist(AnolisTree$edge.length, col='black', border='white', main="", xlab="edge lengths for the Anolis tree", ylim=c(0, 50), xlim=c(0, 6))
tipEdges<-which(AnolisTree$edge[,2] <= Ntip(AnolisTree)
Lengths<-AnolisTree$edge.length
Lengths<-AnolisTree$edge.length
names(Lengths)<-AnolisTree$tip.label
names(Lengths)[which(Lengths == min(Lengths))]
plot(AnolisTree, cex=0.25)
Labs<-sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
summary(AnolisTree$edge.length)
View(AnolisTree)
shortest_edge<-min(AnolisTree$edge.length)
Ntip(AnolisTree)
shortest_edge_which <- which(AnolisTree$edge.length == shortest_edge)
AnolisTree2<-drop.tip(AnolisTree, tip = 82L)
plot(AnolisTree2, cex = 0.25)
Ntip(AnolisTree2)
ltt(AnolisTree)
abline(0, 1, lwd=2, col='red', lty=2)
fit.bd(AnolisTree, rho = 0.2)
ltt(AnolisTree2)
abline(0, 1, lwd=2, col='red', lty=2)
fit.bd(AnolisTree2, rho = 0.2)
pdf("007_plot01.pdf")
dev.off()
dev.off()
dev.off()
pdf("007_plot01.pdf")
ltt(AnolisTree2)
abline(0, 1, lwd=2, col='red', lty=2)
fit.bd(AnolisTree2, rho = 0.2)
setwd("/Users/efama137/Desktop/Evolution/Tasks/Task_07")
text.string<-
"(((((((cow, pig), whale),(bat,(lemur,human))),(robin,iguana)),coelacanth),(gold_fish, trout)),shark);"
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
vert.tree<-read.tree(text=text.string)
setwd("/Users/efama137/Desktop/Evolution/Tasks/Task_07")
text.string<-
"(((((((cow, pig), whale),(bat,(lemur,human))),(robin,iguana)),coelacanth),(gold_fish, trout)),shark);"
vert.tree<-read.tree(text=text.string)
library(phytools)
vert.tree<-read.tree(text=text.string)
plot(vert.tree, edge.width=2)
nodelabels(frame="circle", bg='white', cex=1)
vert.tree
str(vert.tree)
tree<-read.tree(text="(((A,B),(C,D)),E);")
plotTree(tree,offset=1)
tiplabels(frame="circle", bg='lightblue', cex=1)
nodelabels(frame="circle", bg='white', cex=1)
tree$tip.label
tree$edge
AnolisTree<- force.ultrametric(read.tree("https://jonsmitchell.com/data/anolis.tre"))
par(las=1)
hist(AnolisTree$edge.length, col='black', border='white', main="", xlab="edge lengths for the Anolis tree", ylim=c(0, 50), xlim=c(0, 6))
tipEdges<-which(AnolisTree$edge[,2] <= Ntip(AnolisTree))
Lengths<-AnolisTree$edge.length
names(Lengths)<-AnolisTree$tip.label
names(Lengths)[which(Lengths == min(Lengths))]
plot(AnolisTree, cex=0.25)
Labs<-sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
summary(AnolisTree$edge.length)
shortest_edge<-min(AnolisTree$edge.length)
Ntip(AnolisTree)
shortest_edge_which <- which(AnolisTree$edge.length == shortest_edge)
AnolisTree2<-drop.tip(AnolisTree, tip = 82L)
plot(AnolisTree2, cex = 0.25)
Ntip(AnolisTree2)
ltt(AnolisTree2)
abline(0, 1, lwd=2, col='red', lty=2)
fit.bd(AnolisTree2, rho = 0.2)
dev.off()
AnolisTree2 <- read.tree("Anolisphylogeny")
plot(tree, type="fan")
tree <- read.tree("https://jonsmitchell.com/data/anolis.tre")
plot(tree, type="fan")
plot(tree, type="fan", cex=0.25)
data<-read.csv("https://jonsmitchell.com/data/svl.csv", stringsAsFactors = F, row.names=1)
svl<-setNames(data$svl, rownames(data))
Ancestors <- fastAnc(tree, svl, vars=TRUE, CI=TRUE)
par(mar=c(0.1,0.1,0.1,0.1))
plot(tree, type="fan", lwd=2, show.tip.label=F)
tiplabels(pch=16, cex=0.25*svl[tree$tip.label])
nodelabels(pch=16, cex=0.25*Ancestors$ace)
obj<-contMap(tree, svl, plot=F)
plot(obj, type="fan", legend=0.7*max(nodeHeights(tree)),sig=2, fsize=c(0.7, 0.9))
fossilData<-data.frame(svl=log(c(25.4, 23.2, 17.7, 19.7, 24, 31)), tip1=c(
"Anolis_anliniger", "Anolis_aliniger", "Anolis_occultus", "Anolis_ricordii
", "Anolis_cristatellus", "Anolis_occultus"), tip2+c("Anolis_chlorcyanus
", "Anolis_coelestinus", "Anolis_hendersoni", "Anolis_cybotes", "Anolis_
angusticeps", "Anolis_angusticeps"))
fossilData<-data.frame(svl=log(c(25.4, 23.2, 17.7, 19.7, 24, 31)), tip1=c(
"Anolis_anliniger", "Anolis_aliniger", "Anolis_occultus", "Anolis_ricordii
", "Anolis_cristatellus", "Anolis_occultus"), tip1+c("Anolis_chlorcyanus
", "Anolis_coelestinus", "Anolis_hendersoni", "Anolis_cybotes", "Anolis_
angusticeps", "Anolis_angusticeps"))
fossilData<-data.frame(svl=log(c(25.4, 23.2, 17.7, 19.7, 24, 31)), tip1=c(
"Anolis_anliniger", "Anolis_aliniger", "Anolis_occultus", "Anolis_ricordii
", "Anolis_cristatellus", "Anolis_occultus"), tip2=c("Anolis_chlorcyanus
", "Anolis_coelestinus", "Anolis_hendersoni", "Anolis_cybotes", "Anolis_
angusticeps", "Anolis_angusticeps"))
fossilNodes<-c()
nodeN<-c()
Node<-fastMRCA(tree, fossilData[i, "tip1"], fossilData[i, "tip2"])
View(data)
View(data)
